{% extends "base.html" %}
{% block content %}
<div id="my-page">
  <h2>{{ user.name }}</h2>
  <img src="{{ user.icon_url }}" style="border-radius: 10px; width: 100px; height: 100px">

  <table style = "table-layout:fixed;" class="table table-striped table-hover ">
    <thead>
    <tr>
      <th style = "width:50px"></th>
      <th style = "width:150px">名前</th>
      <th style = "width:100px">予算</th>
      <th style = "width:230px">営業時間</th>
      <th style = "width:50px">駐車場</th>
      <th style = "width:50px">削除</th>
    </tr>
    </thead>
    <tbody>
      <tr v-for="(restaurant, index) in restaurants">

        <td>[[ restaurant.img_url ]]</td>
        <td><a style="width:100%; height:100%; display:block;" v-bind:href="restaurant.url">[[ restaurant.name ]]</td>
        <td> [[ restaurant.budget ]]</td>
        <td> [[ restaurant.open ]]</td>
        <td> [[ restaurant.parking ]]</td>
        <td> <span class="glyphicon glyphicon-remove" v-on:click="del(index, restaurant)"></span> </td>
      </tr>
    </tbody>
  </table>
</div>

<script>
  var vm = new Vue({
      el: '#my-page',
      delimiters: ["[[", "]]"] ,
      data: {
          restaurants: {{ restaurants | tojson }}
      },
      methods:{
        del: function (index, restaurant){
          if (confirm('本当に削除しますか？')){
            this.restaurants.splice(index, 1)
            restaurant = JSON.parse(JSON.stringify(restaurant))

            data = restaurant
            $.post("/fav", data);
          }
        }
      }
  })

</script>
{% endblock %}